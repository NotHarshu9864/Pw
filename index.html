<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QuickToppers - Live</title>

<style>
/* ——— GLOBAL ——— */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
body{background:#0a0a0a;color:#fff;overflow-x:hidden;}

/* ——— HEADER ——— */
.header{
    position:sticky;top:0;background:#0f0f0f;z-index:999;
    padding:1rem 1.5rem;display:flex;justify-content:space-between;
    align-items:center;border-bottom:2px solid #1a1a1a;
}

/* Cyan Logo */
.logo{
    font-size:2.3rem;font-weight:900;
    background:linear-gradient(120deg,#00eaff,#00bcd4);
    -webkit-background-clip:text;color:transparent;
}

/* Bell Icon */
.bell-wrapper{position:relative;cursor:pointer;width:50px;height:50px;display:flex;align-items:center;justify-content:center;}
.bell-svg{width:32px;height:32px;fill:#fff;transition:0.3s;}
.bell-wrapper:hover .bell-svg{fill:#00eaff;transform:scale(1.1);}

/* Cyan Badge */
.badge{
    position:absolute;top:2px;right:2px;background:#00eaff;color:#000;
    width:20px;height:20px;border-radius:50%;font-size:0.75rem;
    display:flex;align-items:center;justify-content:center;font-weight:bold;
    animation:pulse 2s infinite;box-shadow:0 0 15px rgba(0,234,255,0.5);
}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.2)}}

@keyframes ring{
0%{transform:rotate(0);}10%{transform:rotate(15deg);}
20%{transform:rotate(-10deg);}30%{transform:rotate(15deg);}
40%{transform:rotate(-10deg);}50%{transform:rotate(10deg);}
60%,100%{transform:rotate(0);}
}
.ringing{animation:ring 1s ease-in-out;}

/* Notification Panel */
.notif-panel{
    position:fixed;top:68px;right:15px;width:380px;max-height:85vh;
    background:#111;border-radius:18px;overflow:hidden;
    box-shadow:0 20px 60px rgba(0,0,0,0.8);
    border:1px solid #00eaff33;z-index:9999;display:none;
    transform:translateY(-20px);opacity:0;
    transition:0.4s cubic-bezier(0.25,0.46,0.45,0.94);
}
.notif-panel.show{display:block;transform:translateY(0);opacity:1;}

.notif-header{
    padding:1.2rem;background:#1a1a1a;border-bottom:1px solid #00eaff33;
    display:flex;justify-content:space-between;align-items:center;
}
.notif-header h3{font-size:1.2rem;}
.notif-close{cursor:pointer;font-size:1.8rem;color:#aaa;}

.notif-body{max-height:65vh;overflow-y:auto;padding:0.8rem;}
.notif-item{
    background:#1a1a1a;margin:0.8rem;border-radius:14px;padding:1rem;
    cursor:pointer;transition:0.3s;border:1px solid #00eaff22;
}
.notif-item:hover{background:#1b1f22;border-color:#00eaff55;}

.notif-item strong{color:#00eaff;font-size:1rem;}
.notif-item p{font-size:0.92rem;color:#ddd;margin:6px 0;}
.notif-time{color:#888;font-size:0.8rem;}

/* ——— Tabs ——— */
.container{max-width:1400px;margin:0 auto;padding:1.5rem;}
.tabs{display:flex;justify-content:center;gap:1rem;margin:2rem 0;}

.tab-btn{
    padding:0.9rem 2rem;background:#1a1a1a;border-radius:50px;border:none;
    color:#ccc;cursor:pointer;font-weight:600;transition:0.3s;
    border:1px solid #00eaff22;
}
.tab-btn.active{
    background:#00eaff;color:#000;border-color:#00eaff;
    box-shadow:0 0 15px #00eaff55;
}

/* ——— Cards ——— */
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(340px,1fr));gap:1.5rem;}

.card{
    background:#111;border-radius:20px;overflow:hidden;position:relative;
    box-shadow:0 10px 30px rgba(0,0,0,0.6);transition:0.4s;
    border:1px solid #00eaff22;
}
.card:hover{
    transform:translateY(-10px);
    box-shadow:0 25px 50px rgba(0,234,255,0.25);
}

.thumb img{width:100%;height:220px;object-fit:cover;}

/* Cyan LIVE Tag */
.live-tag{
    position:absolute;top:12px;left:12px;background:#00eaff;color:#000;
    padding:6px 14px;border-radius:25px;font-size:0.8rem;font-weight:bold;
    box-shadow:0 4px 12px rgba(0,234,255,0.4);
}

.info{padding:1.3rem;}
.title{font-size:1.18rem;font-weight:700;margin-bottom:8px;}
.batch{color:#aaa;font-size:0.95rem;margin-bottom:1rem;}

.watch-btn{
    width:100%;padding:1rem;background:#00eaff;border:none;border-radius:50px;
    color:#000;font-weight:bold;font-size:1.05rem;cursor:pointer;transition:0.3s;
}
.watch-btn:hover{background:#00c8d6;transform:scale(1.03);}

/* ——— Modal ——— */
.modal{
    display:none;position:fixed;inset:0;background:rgba(0,0,0,0.98);
    z-index:9999;align-items:center;justify-content:center;padding:1rem;
}
.modal.show{display:flex;}

iframe{
    width:100%;max-width:1100px;height:80vh;border-radius:18px;
    box-shadow:0 20px 60px rgba(0,234,255,0.3);
}

.close{
    position:absolute;top:20px;right:30px;font-size:50px;color:#fff;
    cursor:pointer;z-index:10000;
}

@media(max-width:768px){
    .notif-panel{left:10px;right:10px;width:auto;}
    .grid{grid-template-columns:1fr;}
}
</style>

</head>
<body>

<div class="header">
    <div class="logo">QuickToppers</div>

    <div class="bell-wrapper" onclick="toggleNotif()">
        <svg class="bell-svg" viewBox="0 0 24 24">
            <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5S10.5 3.17 10.5 4v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
        </svg>
        <div class="badge" id="badge">0</div>
    </div>
</div>

<div class="container">

    <!-- TABS -->
    <div class="tabs">
        <button class="tab-btn active" onclick="tab('live')">Live Now</button>
        <button class="tab-btn" onclick="tab('up')">Upcoming</button>
        <button class="tab-btn" onclick="tab('comp')">Recorded</button>
    </div>

    <!-- LIVE TAB -->
    <div id="live" class="tab">
        <div class="grid" id="liveGrid"></div>
    </div>

    <!-- UPCOMING -->
    <div id="up" class="tab" style="display:none">
        <div class="grid" id="upGrid"></div>
    </div>

    <!-- RECORDED TAB -->
    <div id="comp" class="tab" style="display:none">
        <div class="grid" id="recGrid"></div>
    </div>

</div>

<!-- Modal -->
<div id="modal" class="modal" onclick="closeModal(event)">
    <span class="close">&times;</span>
    <iframe id="player" allowfullscreen></iframe>
</div>

<script>
function tab(x){
    document.querySelectorAll('.tab').forEach(e=>e.style.display='none');
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    document.getElementById(x).style.display='block';
    event.target.classList.add('active');
}
function play(id){
    document.getElementById('player').src=`https://www.youtube.com/embed/${id}?autoplay=1&rel=0`;
    document.getElementById('modal').classList.add('show');
}
function closeModal(e){
    if(e && e.target!==e.currentTarget) return;
    document.getElementById('modal').classList.remove('show');
    document.getElementById('player').src='';
}

/* ============================================
   JSON CARD TEMPLATE (ALL SAME UI)
============================================ */
function makeCard(item, type) {
    return `
    <div class="card">
        <div class="thumb">
            <img src="${item.thumb}">
            <div class="live-tag">${type}</div>
        </div>
        <div class="info">
            <div class="title">${item.title}</div>
            <div class="batch">${item.batch}</div>
            <button class="watch-btn" onclick="play('${item.id}')">Watch Now</button>
        </div>
    </div>`;
}

/* ============================================
   LOAD JSON FUNCTION
============================================ */
async function loadJSON(url, gridID, tagName) {
    try {
        let grid = document.getElementById(gridID);
        grid.innerHTML = `<div style="color:#777;text-align:center;padding:2rem">Loading...</div>`;

        let res = await fetch(url);
        let data = await res.json();

        grid.innerHTML = "";

        data.forEach(item => {
            grid.innerHTML += makeCard(item, tagName);
        });

    } catch {
        document.getElementById(gridID).innerHTML =
            `<div style="color:#777;text-align:center;padding:2rem">Failed to load data</div>`;
    }
}

/* ============================================
   CALLING JSON FILES
============================================ */
loadJSON("live.json", "liveGrid", "LIVE NOW");
loadJSON("upcoming.json", "upGrid", "UPCOMING");
loadJSON("recorded.json", "recGrid", "RECORDED");

</script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
  import { getMessaging, getToken, onMessage } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-messaging.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDJDGmaWfMkg9bQ9eQ9UFVZIrY7LUNnEsc",
    authDomain: "quicktoppers-d5aae.firebaseapp.com",
    projectId: "quicktoppers-d5aae",
    storageBucket: "quicktoppers-d5aae.firebasestorage.app",
    messagingSenderId: "238078517041",
    appId: "1:238078517041:web:7c10061ceed655d526da10",
    measurementId: "G-E8JWX6DC15"
  };

  const app = initializeApp(firebaseConfig);
  const messaging = getMessaging(app);

  // Ask permission and get token
  async function requestPermission() {
    console.log("Requesting permission...");

    const permission = await Notification.requestPermission();

    if (permission === "granted") {
      console.log("Permission granted.");

      const token = await getToken(messaging, {
        vapidKey: "BOrBdjL70eRGSQ0Ue9gmDYfwtE3H1Z4pTaVebft_M4Szmpg5A-KPrUHG536_NcgHs4oZXhAFapVmuaMRPQtuoXc"
      });

      console.log("User FCM Token:", token);

      // TODO: Save this token in your database
    } else {
      alert("Please allow notifications.");
    }
  }

  // Handle foreground notifications
  onMessage(messaging, (payload) => {
    console.log("Message received:", payload);
    alert(payload.notification.title + " - " + payload.notification.body);
  });

  // Call function on page load or button click
  requestPermission();
</script>
</body>
</html>